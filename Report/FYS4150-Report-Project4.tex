\documentclass{article}

\usepackage[margin=0.5in,bottom=1in,footnotesep=1in]{geometry}

\usepackage{amsmath}


\usepackage{multicol}
\setlength{\columnsep}{1cm}
\usepackage[]{algorithm2e}

\usepackage{lipsum}% for dummy text
\usepackage[varg]{txfonts}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{multirow}

\usepackage[font=small,labelfont={sf,bf}]{caption}


\usepackage{titlesec}
\titleformat{\section}{\fontfamily{phv}\fontsize{12}{15}\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\fontfamily{phv}\fontsize{10}{15}\itshape}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\fontfamily{phv}\fontsize{9}{15}\bfseries}{\thesubsubsection}{1em}{}


\title{\textbf{FYS4150 Project 4: \\The Ising model in 2 dimensions}}
\author{Marie Foss (\# 56), Maria Hammerstr{{\o}}m (\# 59)}
\date{} % removes date from title

\begin{document}

\maketitle

\begin{abstract}
	\noindent \lipsum[1]
	\vspace*{2ex}
	
	\noindent \textbf{Github:} \textit{https://github.com/mariahammerstrom/Project4}
	\vspace*{2ex}
\end{abstract}



\begin{multicols}{2}

\section{Introduction}

The project deals with the Ising model in two dimensions, without an external magnetic field. The Ising model is a model to study phase transitions at finite temperature for magnetic systems. In its simplest form the \textbf{energy} for a specific microstate $i$ is expressed as

\begin{equation}\label{eq:energy}
	E_i = -J \sum_{<kl>}^{N}s_k s_l,
\end{equation}
with  $s_k=\pm 1$, $N$ is the total number of spins and $J$ is a coupling constant expressing the strength of the interaction between neighboring spins. The symbol $<kl>$ indicates that we sum over nearest neighbors only. We will assume that we have a ferromagnetic ordering, meaning $J> 0$. We will use periodic boundary conditions and the Metropolis algorithm only. 

...

We will be using the \textbf{Boltzmann probability distribution} (PDF) defined as

\begin{equation}\label{eq:distribution}
	w_i = \frac{1}{Z} e^{- \beta E_i},
\end{equation}
where $\beta = 1/kT$ with $k$ the Boltzmann constant and $T$ the temperature, and with $Z$ as the \textbf{partition function} for the canonical ensemble defined as

\begin{equation}\label{eq:partition_func}
	Z = \sum_{i = 1}^{\infty} e^{-\beta E_i}.
\end{equation}
summing over all micro states $i$. $w_i$ expresses the probability of finding the system in a given microstate $i$.

The \textbf{magnetic moment} of a given microstate is

\begin{equation}
	M_i = \sum_j s_j.
\end{equation} 

Some quantities we are interested in calculating, are the \textbf{expection values} for the energy $<E>$ and magnetic moment $<M>$:

\begin{equation}
\begin{aligned}
	<E> &= \frac{1}{Z} \sum_i E_i e^{- \beta E_i} \\
	<M> &= \frac{1}{Z} \sum_i M_i e^{- \beta E_i},
\end{aligned}
\end{equation}
as well as the variances for the energy $\sigma_E^2$ and for the magnetic moment $\sigma_M^2$:

\begin{equation}
\begin{aligned}
	\sigma_E^2 &= <E^2> - <E>^2 \\
	\sigma_M^2 &= <M^2> - <M>^2,
\end{aligned}
\end{equation}
where

\begin{equation}
	\sigma_E^2 = \frac{1}{Z} \sum_i E_i^2 e^{- \beta E_i} - \bigg[ \frac{1}{Z} \sum_i E_i e^{- \beta E_i} \bigg]^2
\end{equation}
First we will assume that we only have two spins in each dimension, that is $L = 2$, where $L$ is the lattice length. In this case, we can find a closed form expression for the partition function in Eq. (\ref{eq:partition_func}) and the corresponding expectation values for $E$, $|{\cal M}|$, the specific heat $C_V$ and the susceptibility $\chi$ as functions of $T$ using periodic boundary conditions. \textbf{Periodic boundary conditions} means that the neighbor to the right of a given spin $s_N$ in Eq. (\ref{eq:energy}) takes the value of $s_1$. Similarly, the neighbor to the left of $s_1$ takes the value of $s_N$. 

In the case $L = 2$ we can write Eq. (\ref{eq:energy}) as:

\begin{equation}\label{eq:energy2}
	E_i = -J \sum_{<kl>}^{N}s_k s_l = -J \sum_{k = 1}^{2} \sum_{l = 1}^{2} s_k s_l = - J (s_1 s_1 + s_1 s_2 + s_2 s_1 + s_2 s_2)
\end{equation}

... EXPRESSIONS! 






\section{Methods}

We write a code for the Ising model which computes the mean energy $E$, mean magnetization $|{\cal M}|$, the specific heat $C_V$ and the susceptibility $\chi$ as functions of  $T$ using periodic boundary conditions for in the $x$ and $y$ directions. Using the Ising model in two dimensions, the number of configurations is given by $2^N$ with $N = L \times L$ number of spins for a lattice of length $L$. 

We will use the \textbf{Metropolis algorithm}. The algorithm goes as follows:

\begin{enumerate}
	\item Generate a random configuration in the lattice to create an initial state with energy $E_b$.
	\item Change the initial configuration by flipping for example one spin only. Compute the energy of this state $E_t$.
	\item Calculate $\Delta E = E_t - E_b$.
	\item \textit{The Metropolis test:} If $\Delta E \leq 0$ the new configuration is accepted, meaning the energy is lowered and we are moving towards the energy minimum at a given temperature. If $\Delta E > 0$, calculate $w = e^{- \beta \Delta E}$. If $w < r$ where $r$ is a random number, accept the new configuration. If else, keep the old configuration.
	\item Compute the new energy $E' = E_t 0 \Delta E$. Calculate various expectation values using this energy.
	\item Repeat steps $2-5$ for the chosen number of Monte Carlo cycles, meaning the number of times we should sweep through the lattice and summed over all spins.
	\item Compute the various expectation values by dividing by the total number of cycles (and possibly the number of spins).
\end{enumerate}





\section{Results}

Our numerical results from computing the mean energy $E$, mean magnetization $|{\cal M}|$, the specific heat $C_V$ and the susceptibility $\chi$ as functions of $T$ using periodic boundary conditions, can be compared with expressions given in Eq. (\ref{eq:energy2}) - (?) for a temperature $T=1.0$ (in units of $kT/J$). This gives the following results:

\begin{center}
\begin{tabular}{ l l l }\hline
	Quantity 								& Closed form	 				& Numerical		\\ \hline
	Mean energy $E$ 						& - 							& -		 \\
	Mean magnetization $|{\cal M}|$ 			& -							& -		 \\
	Specific heat $C_V$						& -							& - 		\\
	Susceptibility $\chi$						& -							& -		\\
	\hline
\end{tabular}
\end{center}
The number of Monte Carlo cycles needed to achieve good agreement is XXX.

Next we looked at the case of $L = 20$ spins in the $x$ and $y$ directions. In this case we wanted to perform a study of the time (or number of Monte Carlo cycles) we need before reaching an equilibrium situation and can start computing the various expectation values. 

A rough and study is done by plotting the various expectation values as a function of number of Monte Carlo cycles, for both $T = 1.0$ kT/J and T = $2.4$ kT/J, as shown in Fig. XXX. PLOT + COMMENTS!

We also study the total number of accepted configurations as a function of the total number of Monte Carlo cycles, shown in Fig. XXX. PLOT + COMMENTS! 

...

By simply counting the number of times a given energy appears in our computation we can compute the probability $w_i$. MORE. 




\section{Conclusions}

...





\section{List of codes}

...

\end{multicols}

\end{document}
